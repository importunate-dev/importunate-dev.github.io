---
layout: post
title: ' 서비스 분리시키기 '
subtitle: ' 2024년 9월 4일 수요일 '
catalog: true
category: log
subcategory: weekly
tags:
  - log
  - weekly
  - september
  - 2024

---

# Today I Learned

## 날짜

2024년 9월 4일 수요일

## 내용

### 기존 서비스 분리

알파플러스에 기생(?)시켜놨던 인스타그램 코멘트 기능을 분리했다. 사실 애초에 만들때도 같은 서버에 있을 뿐 서로 연관은 전혀 없도록 해놨기 떄문에 그냥 복붙하면 될줄 알았는데… 바로 다음 스프린트인 네이버 플랫폼 추가를 고려하느라 데이터베이스를 열심히 수정해놨더니 제대로 되는게 하나도 없다… 데이터베이스의 구조가 바뀐다는 로직도 변경되야 할 수 있음을 간과했다.

 예를 들어, 현재는 페이스북 계정을 로그아웃 할 경우 기존에 게시해둔 댓글 위젯을 삭제하지 않는다. 다른 계정으로 로그인 했을 떄 연결이 남아있는 것이 있다면 삭제해주는 로직을 취하는데, 이번에는 그럴수가 없게 됐다. 페이스북 로그인, 인스타그램 로그인이 따로 존재하면서 둘 간의 서열이 존재해야 하기 때문이다. 

 페이스북 로그인한 유저는 모든 기능을 사용할 수 있는 반면, 인스타그램 로그인한 유저는 꽤 많은 부분을 사용할 수 없다. 이유를 간략하게 설명하자면, 메타에서 더 다양하고 많은 데이터를 넘겨주는 경우가 인스타그램 계정이 비즈니스 계정일 때인데, 이 계정에는 반드시 연동된 페이스북 페이지를 이용해서만 접근해야하기 때문이다. 비즈니스 계정이라도, 인스타그램 로그인으로 토큰을 받아 API를 요청하면 일반 인스타그램 계정으로서의 데이터만 넘겨준다.. 비즈니스 계정이 아닐 경우, 게시글에 달린 댓글을 받아올 수 없다.

 결국 구멍이 숭숭난 로직을 고치느라 하루종일 애먹었다.

## 회고

데이터독 관련된 세션을 들었다. 뭔말인지 이해하기 힘들었다. 갈 길이 먼 것 같다..