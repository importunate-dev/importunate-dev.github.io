---
layout: post
title: ' shopify 쿠폰 만들기 '
subtitle: ' 2024년 3월 29일 금요일 '
catalog: true
category: log
subcategory: weekly
tags:
  - log
  - weekly
  - march
  - 2024
  - shopify
  - pricerule
  - weekly
  - coupon

---

# Today I Learned

## 날짜

2024년 3월 29일 금요일

## 내용

스프린트 본격적으로 시작!

### 쿠폰 생성

이번 스프린트에서 쿠폰을 생성하는 부분을 맡았다. 아직 한 번도 다뤄본 적 없었던 부분이라 공부가 많이 될거라고 생각했는데, 역시나 머리가 흔들거린다(커서 그런거 아님).

Shopify에는 `PriceRule`이라는 객체가 존재하는데, 이게 쿠폰의 설정모음? 같은 역할을 하는 듯하다. 내가 생성할 쿠폰들에 대한 설정이 여기에 담기고 실제 쿠폰은 `DiscountCode`라는 객체로 생성된다. 결론적으로, PriceRule은 쿠폰을 스토어의 입장에서 다루기 위한 객체고 DiscountCode는 고객이 받아 사용할 부분이라고 생각된다. 

 쇼피파이에서 docs를 봤을때 Price Rule을 고객당 한번만 사용하도록 설정할 수 있었다. 다만, 고객당 중복사용 횟수에 대한 필드가 없었다. 고객은 스토어에서 설정한 횟수만큼 이벤트에 참여하여 쿠폰을 받을 수 있도록 해야하는데, 이에 대한 고민이 들었다. 우선 각 횟차마다 price rule을 생성하는 방향으로 정했다. 이벤트에 처음 참여하는 고객은 1번 pricerule로 부터 발생한 discountcode를 받고 2회차에는 2번, 그 다음 3번으로 설정하면 되지 않을까?

 기존에 리뷰와 관련된 혜택 설정이 존재했기 때문에 살펴보았는데 1개의 price rule마다 1개의 discount-code가 설정되어 있었다. 1개의 리뷰 - 1개의 price rule - 1개의 discount code 가 연관되어 있는데 관련된 히스토리를 좀 더 파악해볼 필요가 있겠다.

### 이슈 관리

퇴근 30분 전에 갑작스레 이슈가 발생했다. 어떤 스토어에서 리뷰 위젯에 이미지가 뜨지 않는 문제였다. 근데 클릭하여 상세보기 페이지에 접속했을 때는 이미지가 정상적으로 출력되고 있었다. 이미지가 로딩되지 않는 파일들은 모두 파일제목에 300이라는 숫자가 붙어있었다.

 찾아보니, 이미지가 뜨지 않는 리뷰는 아마존에서 import 한 리뷰들이었다. 아마존에서 이미지를 가져올때, 원본과 작은사이즈, 중간사이즈를 모두 저장하는데, 이때 중간사이즈는 300, 작은 사이즈는 100을 이름에 붙여 저장한다. 이미지 파일이름에서 ‘._SY’ 를 찾고 그 뒤에 붙이는 로직인데 문제가 되는 파일들은 ._SY가 삭제되고 300이 붙어있어 로딩이 되지않았다. 내가 붙여서 로딩해보니 원하는 사이즈의 이미지가 잘나타났다.

 아마존에서 가져오는 모든 리뷰의 사진이 문제가 되는게 아니기도 하고, _SY가 파일에 붙는지에 대한 파악은 못했다. 병원 예약 떄문에… 만약 같은 이슈가 반복된다면 이에 대해 좀더 알아볼 필요가 있겠다.

 

## 회고

바쁘다 바빠 현대사회